<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.css">
    <style>
        .minus,
        .plus {
            width: 30px;
            height: 30px;
            background: #f2f2f2;
            border-radius: 4px;
            padding: 8px 5px 8px 5px;
            border: 1px solid #ddd;
            display: inline-block;
            vertical-align: middle;
            text-align: center;
        }

        .charminput {
            height: 34px;
            width: 40px;
            text-align: center;
            font-size: 26px;
            border: 1px solid #ddd;
            border-radius: 4px;
            display: inline-block;
            vertical-align: middle;
        }
    </style>
    <title>B2CHARM</title>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <form id="filter_form" method="POST">
                    {% csrf_token %}
                    <div class="col-3" style="display: inline-block;">
                        <div class="card" style="height: 300px; overflow-y: scroll;width: 300px;">
                            <article class="card-group-item">
                                <header class="card-header">
                                    <h6 class="title">Filter 1 </h6>
                                </header>
                                <div class="filter-content">
                                    <div class="card-body">
                                        <label> Initial particles</label>
                                        <button id="btnini">Clear Selection</button>
                                        {{ form.initial }}
                                    </div>
                                </div>
                            </article>
                        </div>
                    </div>
                    <div class="col-3" style="display: inline-block;">
                        <div class="card" style="height: 300px; overflow-y: scroll;width: 300px;">
                            <article class="card-group-item">
                                <header class="card-header">
                                    <h6 class="title">Filter 2 </h6>
                                </header>
                                <div class="filter-content">
                                    <div class="card-body">
                                        <label>Type of observable</label>
                                        <button id="btnobs">Clear Selection</button>
                                        {{ form.observable }}
                                    </div>
                                </div>
                            </article>
                        </div>
                    </div>
                    <div class="col-3" style="display: inline-block;">
                        <div class="card" style="height: 300px; overflow-y: scroll;width: 300px;">
                            <article class="card-group-item">
                                <header class="card-header">
                                    <h6 class="title">Filter 3 (Charm Mesons) </h6>
                                </header>
                                <div class="filter-content">
                                    <div class="card-body ">
                                        <button id="btncharm">Reset fields</button>
                                        <div class="charminput2">
                                            <ul>
                                                <li>
                                                    <div class="number">
                                                        <span>D0</span>
                                                        <span class="minus">-</span>
                                                        {{ form.D0 }}
                                                        <span class="plus">+</span>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="number">
                                                        <span>D+</span>
                                                        <span class="minus">-</span>
                                                        {{ form.Dplus }}
                                                        <span class="plus">+</span>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="number">
                                                        <span>Ds</span>
                                                        <span class="minus">-</span>
                                                        {{ form.Ds }}
                                                        <span class="plus">+</span>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="number">
                                                        <span>D*0</span>
                                                        <span class="minus">-</span>
                                                        {{ form.Ds0 }}
                                                        <span class="plus">+</span>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="number">
                                                        <span>D*+</span>
                                                        <span class="minus">-</span>
                                                        {{ form.Dsplus }}
                                                        <span class="plus">+</span>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="number">
                                                        <span>Ds*</span>
                                                        <span class="minus">-</span>
                                                        {{ form.Dss }}
                                                        <span class="plus">+</span>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="number">
                                                        <span>D**</span>
                                                        <span class="minus">-</span>
                                                        {{ form.Dsss }}
                                                        <span class="plus">+</span>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="number">
                                                        <span>Ds**</span>
                                                        <span class="minus">-</span>
                                                        {{ form.Dssss }}
                                                        <span class="plus">+</span>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </article>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <br>
    <hr>
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <table cellpadding="0" cellspacing="0" border="0" class="table" id="table1" align="center">
                    <thead>
                        <tr>

                            <th>Latex</th>
                            <th>Unit</th>
                            <th>Value and Error</th>
                            



                        </tr>
                    </thead>
                    <tfoot>
                        <tr>

                            <th>Latex</th>
                            <th>Unit</th>
                            <th>Value and Error</th>
                            

                        </tr>
                    </tfoot>
                    <tbody>

                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script type="text/javascript" charset="utf8"
        src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.js"></script>
    <script>
        $(document).ready(function () {
            function formsubmit() {
                $("#filter_form").submit(function (e) {
                    return false;
                });
                console.log("form submitted!")
                console.log("getting data")
                var serializedData = $('#filter_form').serialize();
                $.ajax({
                    url: "{% url 'post_form' %}",
                    type: "POST",
                    data: serializedData,
                    success: function (json_response) {
                        console.log(json_response);
                        console.log("success");
                        $('#table1').DataTable({
                            data: JSON.parse(json_response),
                            stateSave: true,
                            responsive: true,
                            bDestroy: true,
                            "sDom": '<"top"flp>rt<"bottom"i><"clear">',
                            drawCallback: function () {
                                $('.paginate_button', this.api().table().container())
                                    .on('click', function () {
                                        MathJax.typeset();
                                    });
                            },
                            columns: [
                                { data: 'latex' },
                                { data: 'unit' },
                                { data: 'value' },
                                
                            ],

                        });
                        MathJax.typeset();
                    },
                    error: function (xhr, errmsg, err) {
                        console.log(xhr.status + ": " + xhr.responseText);
                    }
                });


            }
            $('.formbtn').on('change', function (event) {
                formsubmit();

            });

            $('#btnini').on('click', function (event) {
                $('input[name=initial]').prop('checked', false);
                formsubmit();
            });

            $('#btnobs').on('click', function (event) {
                $('input[name=observable]').prop('checked', false);
                formsubmit();
            });
            $('.minus').click(function () {
                var $input = $(this).parent().find('input');
                var count = parseInt($input.val()) - 1;
                count = count < 0 ? 0 : count;
                $input.val(count);
                $input.change();
                formsubmit();

            });
            $('.plus').click(function () {
                var $input = $(this).parent().find('input');
                $input.val(parseInt($input.val()) + 1);
                $input.change();
                formsubmit();

            });
            $('#btncharm').on('click', function (event) {
                $('.charminput2 input[type="text"]').each(function () {
                    $(this).val(0);
                });
                formsubmit();
            });
        });


    </script>

    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>MathJax = { tex: { inlineMath: [['$', '$']] } };</script>

</body>

</html>